---
title: "Task 2 - Juvenile Snowshoe Hares in Bonanza Creek Experimental Forest"
author: "Taylor Medina"
date: "11/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(here)
library(kableExtra)
library(lubridate)
library(plotly)
library(effsize)
```

## Juvenile Hare Investigation
```{r}
bonanza_hares <- read_csv(here("data", "bonanza_hares.csv"))

hare_trappings <- bonanza_hares %>% 
  mutate(date = mdy(date), # convert class of date column
         year = year(date)) %>% # splice out year
  group_by(year) %>% 
  summarize(trappings = n()) # get number of trappings per year
```

```{r}
hare_plot <- ggplot(data = hare_trappings,
                    aes(x = year, y = trappings)) +
  geom_point() +
  geom_line() +
  theme_classic() +
  labs(x = "year",
       y = "number of trappings")

ggplotly(hare_plot)
```

```{r}
hare_summary <- hare_trappings %>% 
  summarize(mean_trap = mean(trappings),
            sd_trap = sd(trappings),
            median_trap = median(trappings),
            max_trap = max(trappings),
            min_trap = min(trappings))
 

hare_summary %>% 
kable(col.names = c("mean",
                    "standard deviation",
                    "median",
                    "maximum",
                    "minimum"),
      caption = "Table 1: Statistical Summary of the number of trappings of Bonanza Hares from 1998-2012") %>% 
kable_classic(full_width = FALSE)
```

## Visualizing Juvenile Hare Weights
```{r}
hare_weights <- bonanza_hares %>% 
  group_by(grid, sex) %>% 
  summarize(mean_weight = mean(weight, na.rm = TRUE),
            sd_weight = sd(weight, na.rm = TRUE)) %>%
  mutate(grid = case_when( # replace short names of sites with full names
    grid == "bonbs" ~ "Bonanza Lowland",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonrip" ~ "Bonanza Riparian"))
 
x_axis <- c("female", "male", "NA") # define x-axis labels since they are strings

weight_plot <- ggplot(data = hare_weights,
                      aes(x = sex, y = mean_weight)) +
  geom_bar(stat = "identity", aes(fill = sex)) +
  geom_errorbar(data = hare_weights, 
                mapping = aes(x = sex, ymin = mean_weight - sd_weight, 
                              ymax = mean_weight + sd_weight, size = 0.2, width = 0.1)) +
  facet_wrap(~ grid) +
  theme_classic() +
  scale_y_continuous(expand = c(0,1)) +
  scale_x_discrete(labels = x_axis) + # manually define x-axis
  labs(x = "sex",
       y = "mass (g)",
       fill = "sex")
  

ggplotly(weight_plot)
```

## Statistics of Juvenile Hare Weights
```{r}
hare_stats <- bonanza_hares %>% 
  group_by(sex) %>% 
  summarize(mean_weight = mean(weight, na.rm = TRUE),
            sd_weight = sd(weight, na.rm = TRUE),
            sample_size = n()) %>% 
  filter(sex != "") # remove na row
  
hare_stats %>% 
  kable(col.names = c("sex",
                      "mean weight (g)",
                      "standard deviation (g)",
                      "sample size"),
        caption = "Table 2: Mean weights with standard deviation of Bonanza Hares") %>% 
  kable_classic(full_width = FALSE)

hare_stats_1 <- bonanza_hares %>% 
  select(sex, weight) %>%
  filter(sex != "") 

hare_stats_2 <- hare_stats_1 %>% 
  separate(data = hare_stats_1,
           col = sex,
           into = c("female", "male"),
           )




mean_difference = hare_stats$mean_weight[1] - hare_stats$mean_weight[2]
cohen = cohen.d

```


